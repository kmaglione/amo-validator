from validator.testcases.regex.compat import (COMPAT_REGEXPS,
                                              CheapCompatBugPatternTests)

from ..javascript.entity_values import register_changed_entities
from . import build_definition


TB31_DEFINITION = build_definition(31, thunderbird=True)

COMPAT_REGEXPS.extend([
    (TB31_DEFINITION, CheapCompatBugPatternTests('Thunderbird 31', {
        r'youSendItMgmt\.viewSettings': 894306,
        r'youSendItSettings\.username': 894306,
        r'youSendItMgmt\.needAnAccount': 894306,
        r'youSendItMgmt\.learnMore': 894306,
        r'preferencesCmd\.label': 992643,
        r'preferencesCmd\.accesskey': 992643,
        r'proxy\.label': 992643,
        r'proxy\.accesskey': 992643,
        r'folderPropsCmd\.label': 992643,
        r'folderPropsFolderCmd\.label': 992643,
        r'folderPropsNewsgroupCmd\.label': 992643,
        r'filtersCmd\.label': 992643,
        r'filtersCmd\.accesskey': 992643,
        r'accountManagerCmd\.accesskey': 992643,
        r'accountManagerCmdUnix\.accesskey': 992643,
        r'accountManagerCmd\.label': 992643,
        r'accountManagerCmd\.accesskey': 992643,
        r'accountManagerCmdUnix\.accesskey': 992643,
        r'preferencesCmd\.label': 992643,
        r'preferencesCmd\.accesskey': 992643,
        r'preferencesCmdUnix\.label': 992643,
        r'preferencesCmdUnix\.accesskey': 992643,
        r'findCmd\.label': 530629,
        r'findCmd\.key': 530629,
        r'findCmd\.accesskey': 530629,
        r'ubuntuOneMgmt\.viewSettings': 991220,
        r'UbuntuOneSettings\.emailAddress': 991220,
        r'UbuntuOneSettings\.needAnAccount': 991220,
        r'UbuntuOneSettings\.learnMore': 991220,
        r'propertiesCmd\.label': 992643,
        r'propertiesCmd\.accesskey': 992643,
        r'settingsOfflineCmd\.label': 992643,
        r'settingsOfflineCmd\.accesskey': 992643,
        r'folderContextProperties\.label': 992643,
        r'folderContextProperties\.accesskey': 992643,
        r'folderContextSettings\.label': 992643,
        r'folderContextSettings\.accesskey': 992643,
        r'itemCookies\.label': 953426,
        r'cookies\.intro': 953426,
        r'doNotTrack\.label': 953426,
        r'doNotTrack\.accesskey': 953426,
        r'allowRemoteContent1\.label': 457296,
        r'allowRemoteContent1\.accesskey': 457296,
        r'allowRemoteContent1\.tooltip': 457296,
        r'remoteContentOptionAllowForAddress\.label': 457296,
        r'remoteContentOptionAllowForAddress\.accesskey': 457296,
        r'\b12504\b': 802266,
        r'\b12505\b': 802266,
        r'\b12507\b': 802266,
        r'\b12522\b': 802266,
        r'\b12508\b': 802266,
        r'\b12509\b': 802266,
        r'\b12521\b': 802266,
        r'\b12523\b': 802266,
        r'\b12533\b': 802266,
        r'\b12534\b': 802266,
        r'\b12535\b': 802266,
        r'\b12536\b': 802266,
        r'\b12537\b': 802266,
        r'\b12538\b': 802266,
        r'\b12539\b': 802266,
        r'\b12540\b': 802266,
        r'\b12541\b': 802266,
        r'\b12550\b': 802266,
        r'\b12551\b': 802266,
        r'\b12556\b': 802266,
        r'\b12557\b': 802266,
        r'\b12558\b': 802266,
        r'\b12559\b': 802266,
        r'\b12562\b': 802266,
        r'\b12566\b': 802266,
        r'tooltip\.idleTime': 987577,
        r'receivingMsgs': 86233,
        r'hostContacted': 86233,
        r'noMessages': 86233,
        r'receivedMessages': 86233,
        r'mailnews\.reply_header_authorwrote': 995797,
        r'mailnews\.reply_header_ondate': 995797})),
])

# Thunderbird 31 IDL changes
TB31_ENTITIES = [
    {'name': 'nsIFolderLookupService.getFolderById',
     'status': 'removed', 'bug': 441437, 'compat_type': 'error'},
    {'name': 'nsIAbCard.kAllowRemoteContentProperty',
     'status': 'removed', 'bug': 457296, 'compat_type': 'error'},
    {'name': 'nsIAddrDatabase.addAllowRemoteContent',
     'status': 'removed', 'bug': 457296, 'compat_type': 'error'},
]
register_changed_entities(version_definition=TB31_DEFINITION,
                          entities=TB31_ENTITIES,
                          version_string='Thunderbird 31')

# Thunderbird 31 JS changes
TB31_JS_ENTITIES = [
    {'name': 'ircAccount.kFields.away',
     'status': 'removed', 'bug': 955698, 'compat_type': 'error'},
    {'name': 'ircAccount.kFields.idleTime',
     'status': 'removed', 'bug': 987577, 'compat_type': 'error'},
    {'name': 'updateCharsetPopupMenu',
     'status': 'renamed to EditorUpdateCharsetMenu',
     'bug': 992643, 'compat_type': 'error'},
    {'name': 'EditorSetDocumentCharacterSet',
     'status': 'renamed to EditorSetCharacterSet',
     'bug': 992643, 'compat_type': 'error'},
    {'name': 'EmailConfigWizard.onChangedAuth',
     'status': 'renamed to onChangedInAuth',
     'bug': 883670, 'compat_type': 'error'},
    {'name': 'EmailConfigWizard.onInputUsername',
     'status': 'renamed to onInputOutUsername',
     'bug': 883670, 'compat_type': 'error'},
    {'name': 'awArrowHit',
     'status': 'removed', 'bug': 959209, 'compat_type': 'error'},
    {'name': 'UpdateMailEditCharset',
     'status': 'removed', 'bug': 999881, 'compat_type': 'error'},
    {'name': 'InitCharsetMenuCheckMark',
     'status': 'removed', 'bug': 999881, 'compat_type': 'error'},
    {'name': 'gSecurityPane.readAcceptCookies',
     'status': 'moved to gPrivacyPane.readAcceptCookies',
     'bug': 953426, 'compat_type': 'error'},
    {'name': 'gSecurityPane.writeAcceptCookies',
     'status': 'moved to gPrivacyPane.writeAcceptCookies',
     'bug': 953426, 'compat_type': 'error'},
    {'name': 'gSecurityPane.showCookieExceptions',
     'status': 'moved to gPrivacyPane.showCookieExceptions',
     'bug': 953426, 'compat_type': 'error'},
    {'name': 'gSecurityPane.showCookies',
     'status': 'moved to gPrivacyPane.showCookies',
     'bug': 953426, 'compat_type': 'error'},
    {'name': 'allowRemoteContentForSender',
     'status': 'removed',
     'bug': 457296, 'compat_type': 'error'},
    {'name': 'allowRemoteContentForSite',
     'status': 'renamed to allowRemoteContentForURI',
     'bug': 457296, 'compat_type': 'error'},
    {'name': 'createNewHeaderView',
     'status': 'renamed to HeaderView',
     'bug': 898860, 'compat_type': 'error'},
    {'name': 'FolderDisplayWidget.getVisibleRowPadding',
     'status': 'changed', 'bug': 964824, 'compat_type': 'error'},
]
register_changed_entities(version_definition=TB31_DEFINITION,
                          entities=TB31_JS_ENTITIES,
                          version_string='Thunderbird 31')
